# 21.2.3 监控InnoDB Cluster
本节描述如何使用AdminAPI监控InnoDB Cluster。

[使用Cluster.describe()](#使用Cluster.describe())

[使用Cluster.status()检查集群状态](#使用Cluster.status()检查集群状态)

[监控恢复操作](#监控恢复操作)

[InnoDBCluster和组复制协议](#InnoDBCluster和组复制协议)

[实例上检查MySQL版本](#实例上检查MySQL版本)

## 使用Cluster.describe()

>To get information about the structure of the InnoDB Cluster itself, use the Cluster.describe() function:
```
mysql-js> cluster.describe();
{
    "clusterName": "testCluster",
    "defaultReplicaSet": {
        "name": "default",
        "topology": [
            {
                "address": "ic-1:3306",
                "label": "ic-1:3306",
                "role": "HA"
            },
            {
                "address": "ic-2:3306",
                "label": "ic-2:3306",
                "role": "HA"
            },
            {
                "address": "ic-3:3306",
                "label": "ic-3:3306",
                "role": "HA"
            }
        ]
    }
}
```
>The output from this function shows the structure of the InnoDB Cluster including all of its configuration information, and so on. The address, label and role values match those described at Checking a cluster's Status with Cluster.status() .

获取InnoDB Cluster本身结构的信息，可以使用`Cluster.describe()`。
```
mysql-js> cluster.describe();
{
    "clusterName": "testCluster",
    "defaultReplicaSet": {
        "name": "default",
        "topology": [
            {
                "address": "ic-1:3306",
                "label": "ic-1:3306",
                "role": "HA"
            },
            {
                "address": "ic-2:3306",
                "label": "ic-2:3306",
                "role": "HA"
            },
            {
                "address": "ic-3:3306",
                "label": "ic-3:3306",
                "role": "HA"
            }
        ]
    }
}
```
输出展示了InnoDB Cluster的结构，包括它的所有配置信息等。地址、标签和角色等与`Cluster.status()`一致。

## 使用`Cluster.status()`检查集群状态
>Cluster objects provide the status() method that enables you to check how a cluster is running. Before you can check the status of the InnoDB Cluster, you need to get a reference to the InnoDB Cluster object by connecting to any of its instances. However, if you want to make changes to the configuration of the cluster, you must connect to a "R/W" instance. Issuing status() retrieves the status of the cluster based on the view of the cluster which the server instance you are connected to is aware of and outputs a status report.
>
>The instance's state in the cluster directly influences the information provided in the status report. Therefore ensure the instance you are connected to has a status of ONLINE.
>
>For information about how the InnoDB Cluster is running, use the cluster's status() method:
```
mysql-js> var cluster = dba.getCluster()
mysql-js> cluster.status()
{
    "clusterName": "testcluster", 
    "defaultReplicaSet": {
        "name": "default", 
        "primary": "ic-1:3306", 
        "ssl": "REQUIRED", 
        "status": "OK", 
        "statusText": "Cluster is ONLINE and can tolerate up to ONE failure.", 
        "topology": {
            "ic-1:3306": {
                "address": "ic-1:3306", 
                "mode": "R/W", 
                "readReplicas": {}, 
                "role": "HA", 
                "status": "ONLINE"
            }, 
            "ic-2:3306": {
                "address": "ic-2:3306", 
                "mode": "R/O", 
                "readReplicas": {}, 
                "role": "HA", 
                "status": "ONLINE"
            }, 
            "ic-3:3306": {
                "address": "ic-3:3306", 
                "mode": "R/O", 
                "readReplicas": {}, 
                "role": "HA", 
                "status": "ONLINE"
            }
        }
    }, 
    "groupInformationSourceMember": "mysql://icadmin@ic-1:3306"
}
```
>The output of `Cluster.status()` provides the following information:
>
>- clusterName: name assigned to this cluster during dba.createCluster().
>
>- defaultReplicaSet: the server instances which belong to an InnoDB Cluster and contain the data set.
>
>- primary: displayed when the cluster is operating in single-primary mode only. Shows the address of the current primary instance. If this field is not displayed, the cluster is operating in multi-primary mode.
>
>- ssl: whether secure connections are used by the cluster or not. Shows values of REQUIRED or DISABLED, depending on how the memberSslMode option was configured during either createCluster() or addInstance(). The value returned by this parameter corresponds to the value of the group_replication_ssl_mode server variable on the instance. See Securing your Cluster.
>
>- status: The status of this element of the cluster. For the overall cluster this describes the high availability provided by this cluster. The status is one of the following:
>
>  - ONLINE: The instance is online and participating in the cluster.



## InnoDBCluster和组复制协议
